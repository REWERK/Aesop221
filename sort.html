<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>นิทานอีสป</title>
	<link rel="stylesheet" href="fontawesome/css/all.min.css"> <!-- https://fontawesome.com/ -->
	<link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro&display=swap" rel="stylesheet"> <!-- https://fonts.google.com/ -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/templatemo-xtra-blog.css" rel="stylesheet">
<!--
    
TemplateMo 553 Xtra Blog

https://templatemo.com/tm-553-xtra-blog

-->
</head>
<body>
	<header class="tm-header" id="tm-header">
        <div class="tm-header-wrapper">
            <button class="navbar-toggler" type="button" aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>
            <div class="tm-site-header">
                <div class="mb-3 mx-auto tm-site-logo"><i class="fas fa-book-open fa-2x"></i></div>            
                <h1 class="text-center">Aesop's Fables</h1>
                <p class="text-center text-white">( นิทานอีสป )</p>
            </div>
            <nav class="tm-nav" id="tm-nav">            
                <ul>
                    <li class="tm-nav-item"><a href="index.html" class="tm-nav-link">
                        <i class="fas fa-home"></i>
                         Home
                    </a></li>
                    <li class="tm-nav-item"><a href="search.html" class="tm-nav-link">
                        <i class="fas fa-search"></i>
                         Search
                    </a></li>
                    <li class="tm-nav-item"><a href="post-1.html" class="tm-nav-link">
                        <i class="fas fa-pen"></i>
                        New Story
                    </a></li>
                    <li class="tm-nav-item"><a href="about.html" class="tm-nav-link">
                        <i class="fas fa-users"></i>
                        About 
                    </a></li>
                    <li class="tm-nav-item"><a href="contact.html" class="tm-nav-link">
                        <i class="far fa-comments"></i>
                        Contact Us
                    </a></li>                   
                    <li class="tm-nav-item active"><a href="sort.html" class="tm-nav-link">
                        <i class="fas fa-sort"></i>
                        Sort
                    </a></li>
                </ul>
            </nav>
            <div class="tm-mb-65">
                <a rel="nofollow" href="https://fb.com/templatemo" class="tm-social-link">
                    <i class="fab fa-facebook tm-social-icon"></i>
                </a>
                <a href="https://twitter.com" class="tm-social-link">
                    <i class="fab fa-twitter tm-social-icon"></i>
                </a>
                <a href="https://instagram.com" class="tm-social-link">
                    <i class="fab fa-instagram tm-social-icon"></i>
                </a>
                <a href="https://linkedin.com" class="tm-social-link">
                    <i class="fab fa-linkedin tm-social-icon"></i>
                </a>
            </div>
            <p class="tm-mb-80 pr-5 text-white">
                Binary Seacrh Algorithm 
            </p>
        </div>
    </header>
    <div class="container-fluid">
        <main class="tm-main">
            <!-- Search form -->
            <div class="row tm-row">
                <div class="col-12">
                    <form method="GET" class="form-inline tm-mb-80 tm-search-form" id="form">                
                        <input id="date" class="form-control tm-search-input" name="query" type="text" placeholder="Search..." aria-label="Search">
                        <button class="tm-search-button" type="submit">
                            <i class="fas fa-search tm-search-icon" aria-hidden="true"></i>
                        </button>                              
                    </form>
                </div>                
            </div>            
            <div class="row tm-row" id=result>
            </div>
            <footer class="row tm-row">
                <hr class="col-12">
                <div class="col-md-6 col-12 tm-color-gray">
                    References: <a rel="nofollow" target="_parent" href="https://templatemo.com" class="tm-external-link">TemplateMo ,</a>
                    <a rel="nofollow" target="_parent" href="https://story.momandbaby.net/category/aesops-fables/page/2/" class="tm-external-link">Stories Momandbaby</a>
                </div>
                <div class="col-md-6 col-12 tm-color-gray tm-copyright">
                    
                </div>
            </footer>
        </main>
    </div>
    <script src="js/jquery.min.js"></script>
    <script src="js/templatemo-script.js"></script>
    <script>
    const results = [{name:'กระต่ายกับเต่า',href:'post-1.html' ,image:'img/img-01.jpg',sum:'กระต่ายตัวหนึ่งดูถูกในความคลานได้ช้าต้วมเตี้ยมของเต่า จึงได้ท้าทายให้เต่าวิ่งแข่งกับตน...',date:'Nov. 12, 2021'}, 
                        {name:'ราชสีห์กับหนู',href:'post-2.html' ,image:'img/img-02.jpg',sum:'สิงโตกำลังนอนหลับอย่างสบายใจ อยู่ๆก็มีหนูตัวหนึ่งไต่ขึ้นไปบนหลังของสิงโตและวิ่งเล่นอยู่บนนั้น...',date:'Nov. 8, 2021'}, 
                        {name:'สุนัขกับเงา',href:'post-3.html' ,image:'img/img-09.jpg',sum:'ในวันหนึ่ง มีสุนัขตัวหนึ่งกำลังคาบชิ้นเนื้ออยู่ในปากและกำลังข้ามสะพานอยู่ เมื่อเขามองลงไปในแม่น้ำก็พบว่ามีสุนัขอีกตัวกำลังคาบชิ้นเนื้ออยู่ในปากเหมือนกัน...',date:'Nov. 6, 2021'}, 
                        {name:'ลากับหมาป่า',href:'post-4.html' ,image:'img/img-03.jpg',sum:'ในวันหนึ่ง ขณะที่ลากำลังหากินในทุ่งหญ้า เขาเห็นหมาป่าตัวหนึ่งกำลังมาหาเขา ลาจึงได้แกล้งทำเป็นบาดเจ็บ หมาป่าเข้ามาหาลา...',date:'Nov. 1, 2021'}, 
                        {name:'เทพเฮอร์มีสกับช่างฝีมือ',href:'post-5.html' ,image:'img/img-04.jpg',sum:'กาลครั้งหนึ่ง เทพเจ้าซุสได้สั่งให้เทพเฮอร์มีส ใช้ “ยาแห่งการโกหก” ให้กับช่างฝีมือทุกคน เฮอร์มีสบดยาแบ่งเท่า ๆ กันแล้วนำไปใส่ให้ช่างฝีมือทีละคน...',date:'Oct. 30, 2021'}, 
                        {name:'หมาป่ากับคนเลี้ยงแกะ',href:'post-6.html' ,image:'img/img-05.jpg',sum:'เด็กเลี้ยงแกะพบลูกหมาป่า จึงได้เก็บพวกมันมาเลี้ยง “ถ้าฉันเลี้ยงหมาป่าพวกนี้ เมื่อพวกเขาโตขึ้นจะได้ช่วยเลี้ยงแกะทั้งฝูงหรือพวกเขาอาจจะเอาแกะจากฟาร์มอื่นมาด้วยก็ได้”',date:'Oct.27, 2021'}, 
                        {name:'นกนางแอ่นขี้โม้กับอีกา',href:'post-7.html' ,image:'img/img-06.jpg',sum:'มีนกนางแอ่นและอีกาชวบพูดอวดกันทั้งคู่ หลังจากที่ฟังนกนางแอ่นพูดเกี่ยวกับตัวเองแล้วอีกาก็พูดกลับไปว่า...',date:'Oct. 23, 2021'}, 
                        {name:'แม่ที่รวยกับผู้หญิงที่ร้องไห้',href:'post-8.html' ,image:'img/img-07.jpg',sum:'มีแม่ที่รวยคนหนึ่งมีลูกสาวสองคน เมื่อลูกสาวคนหนึ่งจากไป...',date:'Oct. 20, 2021'}, 
                        {name:'หนูกับวัวกระทิง',href:'post-9.html' ,image:'img/img-08.jpg',sum:'เจ้าวัวกระทิงโกรธเมื่อหนูกัดเขา เขาจึงพยายามจับหนู...',date:'Oct. 16, 2021'}, 
                        {name:'สามีขี้เมากับภรรยาของเขา',href:'post-10.html' ,image:'img/img-10.jpg',sum:'มีภรรยาคนหนึ่งทุกข์ใจจากสามีที่ดื่มเหล้ามากเกินไป เธอต้องการให้เขาเลิกนิสัยไม่ดีนี้ ดังนั้นเธอจึงคิดแผนบางอย่าง...',date:'Oct. 14, 2021'}, 
                        {name:'มดกับนกพิราบ',href:'post-11.html' ,image:'img/img-11.jpg',sum:'มดตัวหนึ่งลงมาที่น้ำพุเพื่อดื่มน้ำ เขาพลาดท่าตกลงไปในน้ำพุและเกือบจะจมน้ำ นกพิราบที่สังเกตเห็นเหตุการณ์ทั้งหมดได้หักกิ่งไม้เล็ก ๆ...',date:'Oct. 12, 2021'}, 
                        {name:'ลากับผิวหนังสิงโต',href:'post-12.html' ,image:'img/img-12.jpg',sum:'มีลาตัวหนึ่ง ได้นำผิวหนังสิงโตมาคลุมตัวเองไว้ แล้วเดินไปมาเพื่อคุกคามสัตว์อื่น ๆ หลังจากนั้นไม่นานสุนัขจิ้งจอกก็ปรากฏตัวขึ้น...',date:'Oct. 9, 2021'}, 
                        {name:'หมาป่ากับคนเลี้ยงแกะ',href:'post-13.html' ,image:'img/img-13.jpg',sum:'มีหมาป่าตัวหนึ่งกำลังเดินติดตามฝูงแกะ แต่เขาไม่ได้โจมตีพวกมัน คนเลี้ยงแกะคิดว่าหมาป่าเป็นภัยคุกคาม ดังนั้นเขาจึงเฝ้าดูแลแกะอย่างกลัวๆ...',date:'Oct. 5, 2021'}, 
                        {name:'เหยี่ยวดำกับงู',href:'post-14.html' ,image:'img/img-14.jpg',sum:'เหยี่ยวดำจับงูแล้วบินขึ้นไปบนฟ้า งูตัวนั้นพันตัวอยู่รอบ ๆ เหยี่ยวดำ แล้วได้กัดไปที่เหยี่ยวดำด้วย...',date:'Oct. 3, 2021'}, 
                        {name:'อีกากับเทพเจ้าเฮอร์มีส',href:'post-15.html' ,image:'img/img-15.jpg',sum:'มีอีกาตัวหนึ่ง ติดอยู่ที่กับดัก ได้ขอร้องเทพเจ้าอพอลโลว่า “ถ้าคุณจะช่วยฉันให้พ้นจากกับดักนี้ฉันจะจุดธูปและบูชาคุณ”...',date:'Sep. 28, 2021'}, 
                        {name:'หงส์ที่เข้าใจผิดว่าตัวเองเป็นห่าน',href:'post-16.html' ,image:'img/img-16.jpg',sum:'เศรษฐีคนหนึ่งได้เลี้ยงทั้งห่านและหงส์ เขาเลี้ยงห่านเพื่อเป็นอาหารในอนาคตของเขา และเลี้ยงหงส์เพื่อส่งเสียงไพเราะ...',date:'Sep. 26, 2021'}, 
                        {name:'ดอกกุหลาบกับดอกซีโลเซีย',href:'post-17.html' ,image:'img/img-17.jpg',sum:'ดอกซีโลเซียกำลังเบ่งบานอยู่ถัดจากดอกกุหลาบ และได้กล่าวกับดอกกุหลาบว่า...',date:'Sep. 24, 2021'}, 
                        {name:'นกยูงกับอีกา',href:'post-18.html' ,image:'img/img-18.jpg',sum:'พวกนกทั้งหลายกำลังหารือกันเพื่อเลือกราชาของพวกเขา แล้วนกยูงก็พูดว่า “ฉันสวยดังนั้นฉันต้องเป็นราชา”...',date:'Sep. 18, 2021'}, 
                        {name:'ปลาทูน่ากับโลมา',href:'post-19.html' ,image:'img/img-19.jpg',sum:'เสียงของปลาทูน่าที่กำลังว่ายน้ำหนีโลมาอย่างหมดหวัง อย่างไรก็ตามโลมากำลังเข้ามาใกล้มากขึ้นเรื่อย ๆ ...',date:'Sep. 16, 2021'}, 
                        {name:'สุนัขจิ้งจอกกับเสือดาว',href:'post-20.html' ,image:'img/img-20.jpg',sum:'สุนัขจิ้งจอกกับเสือดาวกำลังโต้เถียงกัน ว่าใครสวยงามกว่ากัน...',date:'Sep. 13, 2021'}, 
                        {name:'กบสองตัว',href:'post-21.html' ,image:'img/img-21.jpg',sum:'มีกบสองตัวอาศัยอยู่ในละแวกนั้น หนึ่งในนั้นอาศัยอยู่ริมสระน้ำลึกและใหญ่ห่างจากถนนเล็กน้อย...',date:'Sep. 8, 2021'}, 
                        {name:'กากับเชือก',href:'post-22.html' ,image:'img/img-22.jpg',sum:'ชายคนหนึ่งจับอีกาได้ และได้ให้กับลูกของเขา โดยที่ใช้สายจูงผูกขาของมันเอาไว้...',date:'Sep. 6, 2021'}, 
                        {name:'กาดำกับหงส์ขาว',href:'post-23.html' ,image:'img/img-23.jpg',sum:'เมื่ออีกามองไปที่หงส์ อีกาก็รู้สึกอิจฉาในขนสีขาวเหลือเกิน เขาคิดว่าหงส์ต้องล้างขนของตัวเองด้วยน้ำ...',date:'May 31, 2020'}, 
                        {name:'เทพเจ้าแห่งสงครามกับเทพีแห่งความรุนแรง',href:'post-24.html' ,image:'img/img-24.jpg',sum:'เทพเจ้าทั้งหมดตัดสินใจที่จะแต่งงานและแต่ละคนก็เลือกคู่ของเขาโดยการจับฉลาก...',date:'June 16, 2020'}];

        results.sort((a,b) => new Date(a.date).getTime() - new Date(b.date).getTime());
        results.reverse()

        console.log(results)

        function binarySearch(arr, val, start = 0, end = arr.length - 1) {
            const mid = (start + end) >> 1

            if (val === arr[mid])
                return mid

            if (start >= end)
                return -1

            return val < arr[mid]
                ? binarySearch(arr, val, start, mid - 1)
                : binarySearch(arr, val, mid + 1, end);
        }

        // แปลงวันที่เป็นเลข 
        function dateCheckSum(dateString) {
            const date = new Date(dateString)

            const month = date.getMonth()
            let time = ''

            if(month < 10)
                time += '0' + month 
            else
                time += month

            const day = date.getDate()
            if(day < 10)
                time += '0' + day 
            else
                time += day

            time += date.getYear()

            return +time
        }
        
        const timeCheckSum = results.map((current) => ({ 
            ...current, 
            date: dateCheckSum(current.date), // กลายเป็น checksum
            displayDate: current.date // = วันที่เดิม
        }))
        timeCheckSum.sort((a, b) => a.date - b.date)

        form.addEventListener("submit", (e) => {
            // ทำให้หน้าไม่รีโหลด
            e.preventDefault()

            // แปลงวันที่ string ให้กลายเป็น unix timestamp นับ(1/1/1970)
            const date = new Date(document.getElementById("date").value)
            const time = dateCheckSum(date)

            const pivot = binarySearch(timeCheckSum.map(a => a.date), time)
            let currentPivot = pivot - 1

            const searchResults = []
            
            // Find left side pivot
            while(true) {
                const current = timeCheckSum[currentPivot]

                if(!current) break

                const currentTime = dateCheckSum(current.date)

                if(!current || time !== current.date)
                    break

                searchResults.push(timeCheckSum[currentPivot])
                currentPivot--
            }

            // Add current pivot
            searchResults.push(timeCheckSum[pivot])
            currentPivot = pivot + 1

            // Find right side pivot
            while(true) {
                const current = timeCheckSum[currentPivot]

                if(!current || time !== current.date)
                    break

                searchResults.push(timeCheckSum[currentPivot])
                currentPivot++
            }

            result.innerHTML = ''

            // แสดงผลลัพธ์
            searchResults.forEach(r => {
                result.innerHTML += `
                <article class="col-12 col-md-6 tm-post"> 
                    <hr class="tm-hr-primary">
                    <a href="${r.href}" class="effect-lily tm-post-link tm-pt-20">
                        <div class="tm-post-link-inner">
                            <img src="${r.image}" alt="Image" class="img-fluid">                            
                        </div>
                        <h2 class="tm-pt-30 tm-color-primary tm-post-title">${r.name}</h2>
                    </a>                    
                    <p class="tm-pt-30">
                        ${r.sum}
                    </p>
                    <div class="d-flex justify-content-between tm-pt-45">
                        <span class="tm-color-primary"></span>
                        <span class="tm-color-primary">${r.displayDate}</span>
                    </div>
                    <hr>   
                </article>`
            })
        })

        result.innerHTML = ""

        results.forEach(r => {
            result.innerHTML += `
            <article class="col-12 col-md-6 tm-post"> 
                <hr class="tm-hr-primary">
                <a href="${r.href}" class="effect-lily tm-post-link tm-pt-20">
                    <div class="tm-post-link-inner">
                        <img src="${r.image}" alt="Image" class="img-fluid">                            
                    </div>
                    <h2 class="tm-pt-30 tm-color-primary tm-post-title">${r.name}</h2>
                </a>                    
                <p class="tm-pt-30">
                    ${r.sum}
                </p>
                <div class="d-flex justify-content-between tm-pt-45">
                    <span class="tm-color-primary"></span>
                    <span class="tm-color-primary">${r.date}</span>
                </div>
                <hr>   
            </article>`
        })
    </script>
    <script>
        
    </script>
</body>
</html>
